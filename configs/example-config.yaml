# EndpointBOM Configuration File
# This file can be used to configure the behavior of the EndpointBOM scanner

# Paths to exclude from scanning (in addition to built-in sensitive paths)
# Built-in exclusions include: .ssh, .aws, .gnupg, .kube, /etc/shadow, etc.
exclude_paths:
  # Add additional paths to exclude
  # - /path/to/exclude
  # - C:\Path\To\Exclude
  # - /opt/proprietary-software

# Scanners to disable (comment out or remove to enable all)
disabled_scanners:
  # Browser Extensions (DISABLED BY DEFAULT)
  # These require Full Disk Access on macOS 10.14+ (TCC permissions)
  # To enable: Remove from this list AND configure TCC via MDM (see DeploymentDocs/JAMF_DEPLOYMENT.md)
  - chrome-extensions
  - firefox-extensions
  - edge-extensions
  - safari-extensions
  
  # Package Managers
  # - npm
  # - pip
  # - yarn
  # - pnpm
  # - brew
  # - gem
  # - cargo
  # - composer
  # - chocolatey
  # - go
  
  # Applications
  # - applications
  
  # IDEs
  # - vscode
  # - cursor
  # - jetbrains
  # - sublime

# Require admin/root privileges (default: false)
# When false, the tool auto-adjusts behavior based on actual privileges
# When true, the tool will fail if not running as admin
require_admin: false

# Scan all user profiles (default: true)
# Automatically adjusts to current user only if not running as admin
# This is the expected behavior for enterprise endpoint inventory
scan_all_users: true

# Output directory for SBOM files
# Default: ./scans (next to executable)
# The directory is validated to prevent writing to system locations
output_dir: "./scans"

# Enable debug output (default: false)
debug: false

# Enable verbose output (default: false)
verbose: false

# Disable public IP gathering from external services (default: false)
# When enabled, public IP will not be queried from external services
# This avoids making external network requests to untrusted services
disable_public_ip: false

# === Historical Tracking Options ===

# Days to look back for historical package installations (default: 30)
# Scans logs and package metadata to find packages installed in the last N days
# Useful for incident response to see what was installed even if later removed
historical_lookback_days: 30

# Enable historical package tracking from logs (default: true)
# When enabled, scans npm logs, brew history, etc. for recent installations
# Provides "point-in-time" visibility beyond just currently installed packages
include_historical: true

# Include raw log files in zip archive (default: true)
# When enabled, relevant log files (npm logs, etc.) are included in the zip
# Useful for forensic analysis during incident response
include_raw_logs: true

# Create zip archive with SBOMs and logs (default: true)
# When enabled, creates a .scan.zip file with all SBOMs and log files
# SBOMs are also kept unzipped in the scans/ directory for easy viewing
create_zip_archive: true

# Security Notes:
# - Config and output paths are validated for security
# - Sensitive files (.ssh, .aws, credentials) are automatically excluded
# - Writing to system directories (/etc, /bin, C:\Windows) is blocked
# - Path traversal attempts are prevented

